(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3305],{11156:function(e,a,t){Promise.resolve().then(t.bind(t,42443))},42443:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return L}});var n=t(57437),s=t(2265),c=t(50413),r=t(35913),i=t(55166),l=t(3650),o=t(77738),d=t(99368),u=t(46682),m=t(30252),h=t(77733),_=t(95381),p=t(25325),b=t(65783),y=t(57834),f=t(56115),g=t(73454),x=t(44052),j=t(17460),v=t(88372),C=t(52875),Z=t(5951);let w={cat_name:"",is_active:!1},S={cat_id:"",cat_name:"",subcat_name:"",is_active:!1};var k=e=>{let a,{isOpen:t,onClose:c,categoryData:r,onAdd:i}=e,[l]=g.Z.useForm(),[d,u]=(0,s.useState)(w),[m,h]=(0,s.useState)(!0),[_]=g.Z.useForm(),[b,y]=(0,s.useState)(S),[f,k]=(0,s.useState)(!1),T=(e,a,t)=>{let n={...b,[a]:e};"cat_id"===a&&t&&(n.cat_name=t.label),y(n)},A=async()=>{k(!0),l.validateFields().then(async()=>{m?(await F().then(()=>i("add",l.getFieldValue("cat_name"))),l.resetFields(),u(w)):(await E().then(()=>i("add",_.getFieldValue("subcat_name"))),_.resetFields(),y(S),b.cat_name=D[0].label),k(!1),c()}).catch(e=>{Z.Z.error(e.message),k(!1)})},F=async()=>{try{await v.Z.createCategory(d)}catch(e){throw console.error(e),e}},E=async()=>{try{await v.Z.createSubcategory(b)}catch(e){throw console.error(e),e}},P=(0,s.useCallback)(()=>r.map(e=>({value:e._id,label:e.cat_name})),[r]),[D,O]=(0,s.useState)(P()),[M,N]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=P();O(e),e.length>0&&(N(e[0].value),y(a=>({...a,cat_id:e[0].value,cat_name:e[0].label})))},[P,d]),(0,n.jsxs)(o.Z,{title:(0,n.jsx)("h3",{children:"Add Category"}),centered:!0,open:t,onOk:()=>{o.Z.confirm({title:(0,n.jsx)("h3",{children:"Confirmation"}),content:(0,n.jsx)(C.Z,{action:"add",record:m?d:b}),className:"confirmation-modal",centered:!0,width:"35%",okText:"Confirm",onOk:()=>A()})},okText:"Add Category",onCancel:()=>{l.resetFields(),_.resetFields(),b.cat_name=D[0].label,c()},okButtonProps:{disabled:(a=!1,(!m||d.cat_name)&&(m||b.subcat_name)||(a=!0),a),loading:f},children:[(0,n.jsx)(g.Z.Item,{label:(0,n.jsx)("h5",{children:"Category Type"}),labelCol:{span:10},labelAlign:"left",className:"mb-2",children:(0,n.jsxs)(x.ZP.Group,{onChange:e=>{h(e.target.value)},value:m,children:[(0,n.jsx)(x.ZP,{value:!0,children:"Category"}),(0,n.jsx)(x.ZP,{value:!1,children:"Subcategory"})]})}),m?(0,n.jsx)(g.Z,{form:l,name:"category_form",children:(0,n.jsx)(g.Z.Item,{label:(0,n.jsx)("h5",{children:"Category name"}),labelCol:{span:10},labelAlign:"left",className:"mb-2",name:"cat_name",rules:[{required:!0,message:"Category name is required"}],children:(0,n.jsx)(p.default,{name:"cat_name",onChange:e=>{u({...d,[e.target.name]:e.target.value})}})})}):(0,n.jsx)("div",{children:(0,n.jsxs)(g.Z,{form:_,name:"subcategory_form",children:[(0,n.jsx)(g.Z.Item,{label:(0,n.jsx)("h5",{children:"Category name"}),labelCol:{span:10},labelAlign:"left",className:"mb-2",name:"cat_id",rules:[{required:!0,message:"Category name is required"}],children:(0,n.jsx)(j.default,{defaultValue:M,onChange:(e,a)=>T(e,"cat_id",a),options:D})}),(0,n.jsx)(g.Z.Item,{label:(0,n.jsx)("h5",{children:"Subcategory name"}),labelCol:{span:10},labelAlign:"left",className:"mb-2",name:"subcat_name",rules:[{required:!0,message:"Subcategory name is required"}],children:(0,n.jsx)(p.default,{name:"subcat_name",onChange:e=>T(e.target.value,"subcat_name")})})]})})]})},T=e=>{let a,{isOpen:t,onClose:c,isParent:r,isCategory:i,data:l,onUpdate:d,title:u,type:m}=e,[h]=g.Z.useForm(),[_,b]=(0,s.useState)({...l}),[y,f]=(0,s.useState)({...l});(0,s.useEffect)(()=>{b({...l}),f({...l}),h.setFieldsValue({...l})},[l,h]);let w=async()=>{let e={true:v.Z.updateCategory,false:v.Z.updateSubcategory},a=r?h.getFieldValue("cat_name"):h.getFieldValue("subcat_name");try{await e[r](l._id,_).then(()=>d("update",a))}catch(e){throw console.error(e),e}},S=async()=>{try{await h.validateFields(),await w(),c()}catch(e){Z.Z.error(e.message),console.error("Validate Failed:",e)}},k=e=>{b({..._,[e.target.name]:e.target.value})},T={labelCol:{span:10},labelAlign:"left",className:"mb-2"};return(0,n.jsxs)(o.Z,{title:(0,n.jsxs)("h3",{children:["Update ",u]}),centered:!0,open:t,onOk:()=>{o.Z.confirm({title:(0,n.jsx)("h3",{children:"Confirmation"}),content:(0,n.jsx)(C.Z,{action:"update",record:_}),className:"confirmation-modal",centered:!0,width:"35%",okText:"Confirm",onOk:()=>S()})},okText:"Update",onCancel:()=>{h.setFieldsValue({...y}),c()},width:"40%",okButtonProps:{disabled:(a=!1,(i&&r&&!_.cat_name||i&&!r&&!_.subcat_name)&&(a=!0),a)},children:[i||!i&&"SPECIFICATION"===l.cat_type?(0,n.jsx)(g.Z.Item,{label:(0,n.jsxs)("h5",{children:[u," Type"]}),labelCol:{span:10},labelAlign:"left",className:"mb-2",children:(0,n.jsxs)(x.ZP.Group,{value:r,disabled:!0,children:[(0,n.jsx)(x.ZP,{value:!0,children:u}),(0,n.jsxs)(x.ZP,{value:!1,children:["Sub",u.toLowerCase()]})]})}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)(g.Z,{form:h,name:"category_form",children:r?(0,n.jsx)(g.Z.Item,{label:(0,n.jsxs)("h5",{children:[u," name"]}),name:"cat_name",...T,rules:[{required:!0,message:"Category name is required"}],children:(0,n.jsx)(p.default,{name:"cat_name",onChange:k})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Z.Item,{label:(0,n.jsxs)("h5",{children:[u," name"]}),name:"cat_id",...T,rules:[{required:!0,message:"Subcategory name is required"}],children:(0,n.jsx)(j.default,{options:[{label:l.parent_name,value:l.cat_id}],disabled:!0})}),(0,n.jsx)(g.Z.Item,{label:(0,n.jsxs)("h5",{children:["Sub",u.toLowerCase()," name"]}),name:"subcat_name",...T,children:(0,n.jsx)(p.default,{name:"subcat_name",onChange:k})})]})})]})};t(47304);var A=t(87138),F=t(16463),E=t(99765),P=t(82649),D=t(50040);let O=e=>e?(0,n.jsx)(l.Z,{color:"green",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Active"}):(0,n.jsx)(l.Z,{bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Inactive"});var M=()=>{let e=(0,F.useRouter)(),[a,t]=(0,s.useState)(!1),[c,r]=(0,s.useState)([]),[l,g]=(0,s.useState)([]),[x,j]=(0,s.useState)(!0),[Z,w]=(0,s.useState)(!1),[S,M]=(0,s.useState)(!0),[N,I]=(0,s.useState)([]),Y=e=>{let a=e.trim();g(c.filter(e=>{let t=(e.cat_name||e.subcat_name).toLowerCase().includes(a.toLowerCase()),n=null;return e.children&&(n=e.children.some(e=>e.subcat_name.toLowerCase().includes(a.toLowerCase()))),t||n}))};(0,s.useEffect)(()=>{g(c)},[c]);let L=(e,a)=>{"edit_category"===e?(w(!0),I(a),a.subcat_name?M(!1):M(!0)):"deactivate"===e?(a.subcat_name?q(a._id,!1):G(a._id,!1)).then(()=>W(e,a.subcat_name||a.cat_name)):"activate"===e?(a.subcat_name?q(a._id,!0):G(a._id,!0)).then(()=>W(e,a.subcat_name||a.cat_name)):(a.subcat_name?V(a._id):z(a._id)).then(()=>W(e,a.subcat_name||a.cat_name))},R=(a,t)=>{if("edit_category"===a)L(a,t);else{if("view_details"!==a)return o.Z.confirm({title:(0,n.jsx)("h3",{children:"Confirmation"}),content:(0,n.jsx)(C.Z,{action:a,record:t}),className:"confirmation-modal",centered:!0,width:"35%",okText:"Confirm",onOk:()=>L(a,t)});e.push("product-category/details?id=".concat(t._id))}},G=async(e,a)=>{try{await v.Z.deactivateCategory(e,a)}catch(e){throw console.error(e),e}},q=async(e,a)=>{try{await v.Z.deactivateSubcategory(e,a)}catch(e){throw console.error(e),e}},z=async e=>{try{await v.Z.deleteCategory(e)}catch(e){throw console.error(e),e}},V=async e=>{try{await v.Z.deleteSubcategory(e)}catch(e){throw console.error(e),e}},U=e=>(0,n.jsx)(d.Z,{menu:{items:K(e)},children:(0,n.jsx)(u.ZP,{children:"Actions"})}),K=e=>i.$u.map(a=>e.is_active&&"activate"===a.key||!e.is_active&&"deactivate"===a.key?null:{key:a.key,label:(0,n.jsx)(m.default,{onClick:()=>R(a.key,e),children:a.label})}).filter(e=>null!==e),B=i.Ch.map(e=>{switch(e.key){case"cat_name":return{...e,render:(e,a)=>(0,n.jsx)(A.default,{href:"product-category/details?id=".concat(a._id),children:a.cat_name||a.subcat_name}),sorter:(e,a)=>(e.cat_name||e.subcat_name).localeCompare(a.cat_name||a.subcat_name)};case"is_active":return{...e,render:e=>O(e),sorter:(e,a)=>a.is_active-e.is_active};case"actions":return{...e,render:(e,a)=>U(a)};case"created_on":case"last_updated_on":return{...e,render:(a,t)=>E.I.formatDate(t[e.key],E.I.CATEGORY_DATE_FORMAT),sorter:(a,t)=>new Date(a[e.key]).getTime()-new Date(t[e.key]).getTime()};default:return{...e,sorter:(a,t)=>(a[e.key]||"").toString().localeCompare((t[e.key]||"").toString())}}}),H=async()=>{try{let e=(await v.Z.getAllCategory()).toSorted((e,a)=>e.cat_name.localeCompare(a.cat_name));r(e),j(!1)}catch(e){throw console.error(e),e}},W=async(e,a)=>{await H().then(()=>j(!1)),P.Z.success("".concat(D.x.formatTitleCase(e)," Category"),"".concat(D.x.formatTitleCase(a)," has been ").concat(e," successfully."))};return(0,s.useEffect)(()=>{H().then()},[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(h.Z,{style:{justifyContent:"space-between",marginBottom:16},children:[(0,n.jsx)(_.Z,{span:8,children:(0,n.jsx)(p.default,{placeholder:"category",prefix:(0,n.jsx)(y.Z,{}),size:"large",onChange:e=>Y(e.target.value)})}),(0,n.jsx)(u.ZP,{type:"primary",icon:(0,n.jsx)(f.Z,{}),iconPosition:"start",onClick:()=>t(!0),children:"Add Category"}),(0,n.jsx)(k,{isOpen:a,onClose:()=>t(!1),categoryData:c,onAdd:W})]}),(0,n.jsx)(b.Z,{columns:B,dataSource:l.map(e=>{let a={...e,key:e._id};return e.children&&e.children.length>0&&(a.children=e.children.map(a=>({...a,key:a._id,parent_name:e.cat_name}))),a}),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1,loading:x}),(0,n.jsx)(T,{isOpen:Z,onClose:()=>w(!1),isParent:S,isCategory:!0,onUpdate:W,title:"Category",data:N})]})};let N=e=>e?(0,n.jsx)(l.Z,{color:"green",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Active"}):(0,n.jsx)(l.Z,{bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Inactive"});var I=()=>{let e=(0,F.useRouter)(),a=(0,F.usePathname)(),[t,c]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),_=(e,a)=>e.map(e=>a.is_active&&"activate"===e.key||!a.is_active&&"deactivate"===e.key?null:{key:e.key,label:(0,n.jsx)(m.default,{onClick:()=>p(e.key,a),children:e.label})}).filter(e=>null!==e),p=(t,s)=>{"view_specification"===t?e.push("".concat(a,"/view-specification?type=").concat(s.cat_type,"&id=").concat(s._id)):o.Z.confirm({title:(0,n.jsx)("h3",{children:"Confirmation"}),content:(0,n.jsx)(C.Z,{action:t,record:s}),className:"confirmation-modal",centered:!0,width:"35%",okText:"Confirm",onOk:()=>g(t,s)})},y={deactivate:{specification:e=>v.Z.deactivateGeneralSpecification(e,!1),subspecification:e=>v.Z.deactivateGeneralSubspecification(e,!1)},activate:{specification:e=>v.Z.deactivateGeneralSpecification(e,!0),subspecification:e=>v.Z.deactivateGeneralSubspecification(e,!0)},delete:{specification:v.Z.deleteGeneralSpecification,subspecification:v.Z.deleteGeneralSubspecification}},g=(e,a)=>{let t=a.subcat_subspec_name?"subspecification":"specification";y[e][t](a._id).then(()=>{var t;return P.Z.success("".concat(D.x.formatTitleCase(e)," Specification"),"".concat(null!==(t=a.subcat_subspec_name)&&void 0!==t?t:a.subcat_spec_name," ").concat(e," successfully"))}).then(w).catch(t=>P.Z.error("".concat(D.x.formatTitleCase(e)," Specification"),"".concat(a.subcat_subspec_name||a.subcat_spec_name," failed to ").concat(e)))},x=(e,a)=>(0,n.jsx)(d.Z,{menu:{items:_(e,a)},children:(0,n.jsx)(u.ZP,{children:"Actions"})}),j=e=>e.map(e=>{switch(e.key){case"subcat_spec_name":return{...e,render:(e,a)=>{let t=a.subcat_spec_name||a.subcat_subspec_name;return(0,n.jsx)("span",{children:t})},sorter:(e,a)=>(e.subcat_spec_name||e.subcat_subspec_name).localeCompare(a.subcat_spec_name||a.subcat_subspec_name)};case"is_active":return{...e,render:e=>N(e),sorter:(e,a)=>a.is_active-e.is_active};case"actions":return{...e,render:(a,t)=>x(e.actionList,t)};case"created_on":case"last_updated_on":return{...e,render:(a,t)=>E.I.formatDate(t[e.key],E.I.CATEGORY_DATE_FORMAT),sorter:(a,t)=>new Date(a[e.key]).getTime()-new Date(t[e.key]).getTime()};default:return{...e,sorter:(a,t)=>(a[e.key]||"").toString().localeCompare((t[e.key]||"").toString())}}}),Z=async()=>{try{l(!0);let e=await v.Z.getAllGeneralSpecifications();c(e)}catch(e){throw console.error(e),e}},w=async()=>{await Z().then(()=>l(!1))};return(0,s.useEffect)(()=>{Z().then(()=>l(!1))},[]),(0,n.jsx)("div",{children:i.ZM.map(s=>(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)(h.Z,{className:"mb-2 justify-between",children:[(0,n.jsx)("h3",{children:s.title}),(0,n.jsx)(u.ZP,{type:"primary",icon:(0,n.jsx)(f.Z,{}),onClick:()=>{e.push("".concat(a,"/add-specification?type=").concat(s.type))},children:s.button})]}),(0,n.jsx)(b.Z,{columns:j(s.tableHeader),dataSource:t.filter(e=>e.cat_type===s.type).map(e=>{let a={...e,key:e._id};return e.children&&e.children.length>0&&(a.children=e.children.map(a=>({...a,key:a._id,parent_name:e.subcat_spec_name,cat_type:e.cat_type}))),a}),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1,loading:r})]},s.key))})};let Y=i.RW.map(e=>({key:e.key,label:e.label,children:"category"===e.key?(0,n.jsx)(M,{}):(0,n.jsx)(I,{})}));var L=()=>{let[e,a]=(0,s.useState)("category");return(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("tab");e&&a(e)},[]),(0,s.useEffect)(()=>{let e=e=>{var t;(null===(t=e.state)||void 0===t?void 0:t.activeTabKey)&&a(e.state.activeTabKey)};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]),(0,n.jsx)(c.default,{title:"Product Category",children:(0,n.jsx)(r.Z,{activeKey:e,items:Y,size:"small",onChange:e=>{a(e),window.history.pushState({activeTabKey:e},"","?tab=".concat(e))}})})}},5951:function(e,a,t){"use strict";var n=t(71768);class s{static showMessage(e,a){switch(e){case"success":return n.ZP.success(a);case"error":return n.ZP.error(a);case"warning":return n.ZP.warning(a);default:return n.ZP.info(a)}}static success(e){return this.showMessage("success",e)}static error(e){return this.showMessage("error",e)}static warning(e){return this.showMessage("warning",e)}static info(e){return this.showMessage("info",e)}}a.Z=s},99765:function(e,a,t){"use strict";t.d(a,{I:function(){return c}});var n=t(62737),s=t.n(n);class c{static formatDate(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.DEFAULT_DATE_FORMAT;return e?s()(e).format(a):""}}c.DEFAULT_DATE_FORMAT="YYYY-MM-DD",c.DEFAULT_DATE_TIME_FORMAT="YYYY-MM-DD HH:mm:ss",c.CATEGORY_DATE_FORMAT="DD MMM YYYY"},47304:function(){}},function(e){e.O(0,[3276,9665,3419,3454,5325,252,4717,5913,7460,7382,7373,7738,4052,6487,5783,509,3328,413,5539,2971,7023,1744],function(){return e(e.s=11156)}),_N_E=e.O()}]);