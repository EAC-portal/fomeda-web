(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{97996:function(e,t,l){Promise.resolve().then(l.bind(l,967))},967:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return F}});var a=l(57437),r=l(2265),n=l(99368),o=l(46682),i=l(3650),s=l(77733),c=l(95381),d=l(65783);let u=[{key:"role_name",title:"Roles name",dataIndex:"role_name",width:"20%"},{key:"created_on",title:"Created date",dataIndex:"created_on"},{key:"last_updated_on",title:"Last updated on",dataIndex:"last_updated_on"},{key:"last_updated_by",title:"Last updated by",dataIndex:"last_updated_by"},{key:"is_active",title:"Status",dataIndex:"is_active",filters:[{text:"Inactive",value:!1},{text:"Active",value:!0}]},{key:"actions",title:"Actions",width:"15%"}],h=[{key:"edit_role",label:"Edit Role"},{key:"activate_role",label:"Activate Role"},{key:"deactivate_role",label:"Deactivate Role"}];var m=l(19486),y=l(56115),x=l(99765),_=l(50413),v=l(17460),p=l(73454),f=l(77738),j=l(25325),k=l(84503),w=l(44785),g=l(49714);let{Option:R}=v.default;var A=e=>{let{visible:t,onClose:l}=e,[r]=p.Z.useForm(),n=async()=>{try{var e;let t;let a=await r.validateFields(),n=w.Z.get("token");if(n)try{t=(0,g.o)(n)}catch(e){console.error(e)}let o=null!==(e=null==t?void 0:t.user_id)&&void 0!==e?e:"UndefinedAdmin",i={...a,created_by:o,last_updated_by:o};try{await m.Z.createRole(i)}catch(e){throw console.error(e),e}r.resetFields(),l()}catch(e){console.log("Validation Failed:",e)}},i=async()=>{r.resetFields(),l()};return(0,a.jsx)(f.Z,{title:(0,a.jsx)("h3",{style:{textAlign:"center"},children:"Create Role"}),open:t,onCancel:i,onOk:n,width:1e3,footer:[(0,a.jsx)(o.ZP,{onClick:i,children:"Cancel"},"cancel"),(0,a.jsx)(o.ZP,{type:"primary",onClick:n,children:"Submit"},"submit")],children:(0,a.jsxs)(p.Z,{form:r,layout:"vertical",children:[(0,a.jsx)(p.Z.Item,{name:"role_name",label:"Role name",rules:[{required:!0,message:"Please enter the role name"}],children:(0,a.jsx)(j.default,{placeholder:"Role name"})}),(0,a.jsx)(p.Z.Item,{label:"Permission module",name:"modules",rules:[{required:!0,message:"Please select at least one module"}],children:(0,a.jsx)(v.default,{mode:"multiple",placeholder:"Select modules",children:k.GK.map(e=>{let{key:t,label:l}=e;return(0,a.jsx)(R,{value:t,children:l},t)})})})]})})};let{Option:Z}=v.default;var b=e=>{let{visible:t,onClose:l,data:n}=e,[i]=p.Z.useForm(),[s,c]=(0,r.useState)({...n});(0,r.useEffect)(()=>{c({...n}),i.setFieldsValue({...n})},[n,i]);let d=async()=>{try{var e;let t;let a=await i.validateFields(),r=w.Z.get("token");if(r)try{t=(0,g.o)(r)}catch(e){console.error(e)}let n=null!==(e=null==t?void 0:t.user_id)&&void 0!==e?e:"UndefinedAdmin",o={...a,last_updated_by:n};try{await m.Z.updateRole(s._id,o)}catch(e){throw console.error(e),e}i.resetFields(),l()}catch(e){console.log("Validation Failed:",e)}},u=async()=>{i.resetFields(),l()};return(0,a.jsx)(f.Z,{title:(0,a.jsx)("h3",{style:{textAlign:"center"},children:"Edit Role"}),open:t,onCancel:u,onOk:d,width:1e3,footer:[(0,a.jsx)(o.ZP,{onClick:u,children:"Cancel"},"cancel"),(0,a.jsx)(o.ZP,{type:"primary",onClick:d,children:"Save"},"submit")],children:(0,a.jsxs)(p.Z,{form:i,layout:"vertical",children:[(0,a.jsx)(p.Z.Item,{name:"role_name",label:"Role name",rules:[{required:!0,message:"Please enter the role name"}],children:(0,a.jsx)(j.default,{placeholder:"Role name"})}),(0,a.jsx)(p.Z.Item,{label:"Permission module",name:"modules",rules:[{required:!0,message:"Please select at least one module"}],children:(0,a.jsx)(v.default,{mode:"multiple",placeholder:"Select modules",children:k.GK.map(e=>{let{key:t,label:l}=e;return(0,a.jsx)(Z,{value:t,children:l},t)})})})]})})};let{Title:E,Paragraph:C,Text:S,Link:T}=l(30252).default,D=e=>{if("activate"===e)return!0;if("deactivate"===e)return!1;throw Error("Invalid type provided")};var O=e=>{let{data:t,type:l,isOpen:n,onSubmit:o,onCancel:i}=e;return r.useEffect(()=>{n&&f.Z.confirm({title:(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)("h3",{children:"activate"===l?"Activate Role":"Deactivate Role"})}),content:(0,a.jsxs)("div",{children:[(0,a.jsxs)(C,{children:["Are you sure you want to ",(0,a.jsx)(S,{strong:!0,children:l})," the following role?"]}),(0,a.jsx)(C,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{strong:!0,children:"Role name: "}),(0,a.jsx)(S,{children:null==t?void 0:t.role_name}),(0,a.jsx)("br",{}),(0,a.jsx)(S,{strong:!0,children:"Created on: "}),(0,a.jsx)(S,{children:x.I.formatDate(null==t?void 0:t.created_on)}),(0,a.jsx)("br",{}),(0,a.jsx)(S,{strong:!0,children:"Last updated on: "}),(0,a.jsx)(S,{children:x.I.formatDate(null==t?void 0:t.last_updated_on)})]})})]}),icon:null,centered:!0,closable:!0,width:"50%",okText:"Confirm",cancelText:"Cancel",onOk:()=>o(null==t?void 0:t._id,D(l)),onCancel:i})},[n,i,o,t,l]),null},P=l(16463),F=()=>{let[e,t]=(0,r.useState)(!1),[l,v]=(0,r.useState)([]),[p,f]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[w,g]=(0,r.useState)(!1),[R,Z]=(0,r.useState)(void 0),[E,C]=(0,r.useState)(null),[S,T]=(0,r.useState)(),D=(0,P.useRouter)(),F=()=>{k(!0)},I=()=>{g(!0)},M=async()=>{try{let e=await m.Z.getAllRoles();v(e)}catch(e){throw console.error(e),e}finally{t(!1)}};(0,r.useEffect)(()=>{M()},[D]);let L=(e,t)=>{"edit_role"===e?(C(t),F()):"activate_role"===e?(C(t),Z("activate"),I()):"deactivate_role"===e&&(C(t),Z("deactivate"),I())},Y=e=>h.map(t=>e.is_active&&"activate_role"===t.key||!e.is_active&&"deactivate_role"===t.key?null:{key:t.key,label:(0,a.jsx)("div",{onClick:()=>L(t.key,e),children:t.label})}).filter(e=>null!==e),U=e=>(0,a.jsx)(n.Z,{menu:{items:Y(e)},children:(0,a.jsx)(o.ZP,{children:"Actions"})}),G=e=>e?(0,a.jsx)(i.Z,{color:"green",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Active"}):(0,a.jsx)(i.Z,{color:"red",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Inactive"}),N=async(e,t)=>{try{await m.Z.updateRole(e,{is_active:t})}catch(e){throw console.error(e),e}g(!1),M()},q=u.map(e=>{switch(e.key){case"actions":return{...e,render:(e,t)=>U(t)};case"created_on":case"last_updated_on":return{...e,render:(t,l)=>x.I.formatDate(l[e.key]),sorter:(t,l)=>new Date(t[e.key]).getTime()-new Date(l[e.key]).getTime()};case"is_active":return{...e,render:e=>G(e),onFilter:(e,t)=>t.is_active===e};default:return{...e,sorter:(t,l)=>(t[e.key]||"").toString().localeCompare((l[e.key]||"").toString())}}});return(0,a.jsxs)(_.default,{title:"Roles Management",children:[(0,a.jsx)(A,{visible:p,onClose:()=>{f(!1),M()}}),(0,a.jsx)(b,{visible:j,onClose:()=>{k(!1),C(null),M()},data:E}),(0,a.jsx)(O,{data:E,type:R,isOpen:w,onSubmit:N,onCancel:()=>{g(!1),M()}}),(0,a.jsxs)("div",{style:{width:"100%"},children:[(0,a.jsxs)(s.Z,{style:{justifyContent:"space-between",marginBottom:16},children:[(0,a.jsx)(c.Z,{style:{display:"flex",gap:"8px"},span:16}),(0,a.jsx)(o.ZP,{type:"primary",icon:(0,a.jsx)(y.Z,{}),iconPosition:"start",onClick:()=>{f(!0)},children:"Add role"})]}),(0,a.jsx)(d.Z,{columns:q,dataSource:l.map(e=>({...e,key:e._id})),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1})]})]})}},19486:function(e,t,l){"use strict";l.d(t,{Z:function(){return n}});var a=l(91413),r=l(86863);class n{}n.getAllRoles=async()=>{try{return await r.O.get(a.P.GET_ALL_ROLES)}catch(e){throw console.error(e),e}},n.getActiveRoles=async()=>{try{return await r.O.get(a.P.GET_ACTIVE_ROLES)}catch(e){throw console.error(e),e}},n.getModules=async e=>{try{return await r.O.get(a.P.GET_MODULES,{id:e})}catch(e){throw console.error(e),e}},n.createRole=async e=>{try{return await r.O.post(a.P.CREATE_ROLE,e)}catch(e){throw console.error(e),e}},n.updateRole=async(e,t)=>{try{return await r.O.patch(a.P.UPDATE_ROLE,t,{id:e})}catch(e){throw console.error(e),e}}},99765:function(e,t,l){"use strict";l.d(t,{I:function(){return n}});var a=l(62737),r=l.n(a);class n{static formatDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_DATE_FORMAT;return e?r()(e).format(t):""}}n.DEFAULT_DATE_FORMAT="YYYY-MM-DD",n.DEFAULT_DATE_TIME_FORMAT="YYYY-MM-DD HH:mm:ss",n.CATEGORY_DATE_FORMAT="DD MMM YYYY"}},function(e){e.O(0,[3276,9665,3419,3454,5325,252,7460,7382,7373,7738,4052,6487,5783,1664,413,2971,7023,1744],function(){return e(e.s=97996)}),_N_E=e.O()}]);