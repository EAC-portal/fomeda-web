(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9084],{78677:function(e,a,t){Promise.resolve().then(t.bind(t,24539))},24539:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var l=t(57437),r=t(2265),s=t(46682),n=t(77733),i=t(95381),d=t(65783);let c=[{key:"fullname",title:"Admin name",dataIndex:"fullname",width:"15%"},{key:"email_address",title:"Admin email",dataIndex:"email_address"},{key:"created_on",title:"Created on",dataIndex:"created_on",width:"10"},{key:"created_by",title:"Created by",dataIndex:"created_by",width:"10%"},{key:"last_updated_on",title:"Last updated on",dataIndex:"last_updated_on",width:"12%"},{key:"last_updated_by",title:"Last updated by",dataIndex:"last_updated_by",width:"12%"},{key:"is_active",title:"Status",dataIndex:"is_active",width:"10%",filters:[{text:"Inactive",value:!1},{text:"Active",value:!0}]},{key:"actions",title:"Actions",width:"10%"}],o=[{value:!0,label:"Active"},{value:!1,label:"Inactive"}];var u=t(68788),m=t(56115),h=t(99765),y=t(50413),p=t(17460),_=t(73454),v=t(77738),x=t(25325),f=t(19486),w=t(44785),j=t(49714);let{Option:A}=p.default;var g=e=>{let{visible:a,onClose:t}=e,[n]=_.Z.useForm(),[i,d]=(0,r.useState)([]);(0,r.useEffect)(()=>{a&&c()},[a]);let c=async()=>{try{let e=await f.Z.getActiveRoles();d(e)}catch(e){throw console.error(e),e}},m=async e=>{try{return await u.Z.checkEmailDuplicate(e)}catch(e){throw console.error(e),e}},h=async e=>{try{return await u.Z.checkUsernameDuplicate(e)}catch(e){throw console.error(e),e}},y=async()=>{try{var e;let a;let l=await n.validateFields(),r=w.Z.get("token");if(r)try{a=(0,j.o)(r)}catch(e){console.error(e)}let s=null!==(e=null==a?void 0:a.user_id)&&void 0!==e?e:"UndefinedAdmin",i={...l,type:"admin",created_by:s,last_updated_by:s};try{await u.Z.register(i)}catch(e){throw console.error(e),e}n.resetFields(),t()}catch(e){console.log("Validation Failed:",e)}},g=async()=>{n.resetFields(),t()};return(0,l.jsx)(v.Z,{title:(0,l.jsx)("h3",{style:{textAlign:"center"},children:"Create Admin"}),open:a,onCancel:g,onOk:y,width:1e3,footer:[(0,l.jsx)(s.ZP,{onClick:g,children:"Cancel"},"cancel"),(0,l.jsx)(s.ZP,{type:"primary",onClick:y,children:"Submit"},"submit")],children:(0,l.jsxs)(_.Z,{form:n,layout:"vertical",children:[(0,l.jsx)(_.Z.Item,{name:"fullname",label:"Admin fullname",rules:[{required:!0,message:"Please enter the admin fullname"}],hasFeedback:!0,children:(0,l.jsx)(x.default,{placeholder:"Admin fullname"})}),(0,l.jsx)(_.Z.Item,{name:"username",label:"Admin username",rules:[{required:!0,message:"Please enter the admin username"},{min:6,max:20,message:"The username must be between 6 and 20 characters"},{whitespace:!0,message:"The username cannot be whitespaces only"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"The username must start with an alphabet and contain only alphanumeric characters and underscores"},{validator:async(e,a)=>a&&await h(a)?Promise.reject(Error("The username is already in use")):Promise.resolve()}],hasFeedback:!0,children:(0,l.jsx)(x.default,{placeholder:"Admin username"})}),(0,l.jsx)(_.Z.Item,{name:"email_address",label:"Admin email",rules:[{required:!0,message:"Please enter the admin email"},{type:"email",message:"Please enter a valid email address"},{validator:async(e,a)=>a&&await m(a)?Promise.reject(Error("The email is already in use")):Promise.resolve()}],hasFeedback:!0,children:(0,l.jsx)(x.default,{placeholder:"Admin email"})}),(0,l.jsx)(_.Z.Item,{name:"role_id",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:(0,l.jsx)(p.default,{placeholder:"Please select a role",children:i.map(e=>(0,l.jsx)(A,{value:e._id,children:null==e?void 0:e.role_name},e._id))})}),(0,l.jsx)(_.Z.Item,{name:"is_active",label:"Status",rules:[{required:!0,message:"Please select a status"}],children:(0,l.jsx)(p.default,{placeholder:"Please select a status",children:o.map(e=>(0,l.jsx)(A,{value:e.value,children:e.label},String(e.value)))})})]})})};let{Option:b}=p.default;var Z=e=>{let{visible:a,onClose:t,data:n}=e,[i]=_.Z.useForm(),[d,c]=(0,r.useState)({...n}),[m,h]=(0,r.useState)([]);(0,r.useEffect)(()=>{c({...n}),i.setFieldsValue({...n}),a&&(y(),n&&i.setFieldsValue({...n,role_id:null==n?void 0:n.role_id}))},[a,n,i]);let y=async()=>{try{let e=await f.Z.getActiveRoles();h(e)}catch(e){throw console.error(e),e}},A=async e=>{try{return await u.Z.checkEmailDuplicate(e)}catch(e){throw console.error(e),e}},g=async()=>{try{var e;let a;let l=await i.validateFields(),r=w.Z.get("token");if(r)try{a=(0,j.o)(r)}catch(e){console.error(e)}let s=null!==(e=null==a?void 0:a.user_id)&&void 0!==e?e:"UndefinedAdmin",n={...l,last_updated_by:s};try{await u.Z.updateAdmin(null==d?void 0:d.user_id,n)}catch(e){throw console.error(e),e}i.resetFields(),t()}catch(e){console.log("Validation Failed:",e)}},Z=async()=>{i.resetFields(),t()};return(0,l.jsx)(v.Z,{title:(0,l.jsx)("h3",{style:{textAlign:"center"},children:"Edit Admin"}),open:a,onCancel:Z,onOk:g,width:1e3,footer:[(0,l.jsx)(s.ZP,{onClick:Z,children:"Cancel"},"cancel"),(0,l.jsx)(s.ZP,{type:"primary",onClick:g,children:"Save"},"submit")],children:(0,l.jsxs)(_.Z,{form:i,layout:"vertical",children:[(0,l.jsx)(_.Z.Item,{name:"fullname",label:"Admin fullname",rules:[{required:!0,message:"Please enter the admin fullname"}],hasFeedback:!0,children:(0,l.jsx)(x.default,{placeholder:"Admin fullname"})}),(0,l.jsx)(_.Z.Item,{name:"username",label:"Admin username",children:(0,l.jsx)(x.default,{placeholder:"Admin username",disabled:!0})}),(0,l.jsx)(_.Z.Item,{name:"email_address",label:"Admin email",rules:[{required:!0,message:"Please enter the admin email"},{type:"email",message:"Please enter a valid email address"},{validator:async(e,a)=>a&&a!==(null==d?void 0:d.email_address)&&await A(a)?Promise.reject(Error("The email is already in use")):Promise.resolve()}],hasFeedback:!0,children:(0,l.jsx)(x.default,{placeholder:"Admin email"})}),(0,l.jsx)(_.Z.Item,{name:"role_id",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:(0,l.jsx)(p.default,{placeholder:"Please select a role",children:m.map(e=>(0,l.jsx)(b,{value:e._id,children:null==e?void 0:e.role_name},e._id))})}),(0,l.jsx)(_.Z.Item,{name:"is_active",label:"Status",rules:[{required:!0,message:"Please select a status"}],children:(0,l.jsx)(p.default,{placeholder:"Please select a status",value:(null==d?void 0:d.is_active)?"active":"inactive",children:o.map(e=>(0,l.jsx)(b,{value:e.value,children:e.label},String(e.value)))})})]})})},k=t(16463),E=t(75785),P=()=>{let[e,a]=(0,r.useState)(!1),[t,o]=(0,r.useState)([]),[p,_]=(0,r.useState)([]),[v,x]=(0,r.useState)(""),[f,w]=(0,r.useState)(""),[j,A]=(0,r.useState)(!1),[b,P]=(0,r.useState)(!1),[S,T]=(0,r.useState)(null),F=(0,k.useRouter)(),I=async()=>{try{let e=await u.Z.getAdmins();o(e),_(e)}catch(e){throw console.error(e),e}finally{a(!1)}};(0,r.useEffect)(()=>{I()},[F]),(0,r.useEffect)(()=>{_(t.filter(e=>{let a=""===v||RegExp(v,"i").test(e.fullname),t=""===f||RegExp(f,"i").test(e.company_name);return a&&t}))},[v,f,t]);let C=(e,a)=>{T(a),P(!0)},D=e=>e?(0,l.jsx)(E.Vp,{color:"green",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Active"}):(0,l.jsx)(E.Vp,{color:"red",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Inactive"}),O=c.map(e=>{switch(e.key){case"actions":return{...e,render:(e,a)=>(0,l.jsx)(s.ZP,{onClick:()=>C(e,a),children:"Edit"})};case"created_on":case"last_updated_on":return{...e,render:(a,t)=>h.I.formatDate(t[e.key]),sorter:(a,t)=>new Date(a[e.key]).getTime()-new Date(t[e.key]).getTime()};case"is_active":return{...e,render:e=>D(e),onFilter:(e,a)=>a.is_active===e};default:return{...e,sorter:(a,t)=>(a[e.key]||"").toString().localeCompare((t[e.key]||"").toString())}}});return(0,l.jsxs)(y.default,{title:"Admins Management",children:[(0,l.jsx)(g,{visible:j,onClose:()=>{A(!1),I()}}),(0,l.jsx)(Z,{visible:b,onClose:()=>{P(!1),T(null),I()},data:S}),(0,l.jsxs)("div",{style:{width:"100%"},children:[(0,l.jsxs)(n.Z,{style:{justifyContent:"space-between",marginBottom:16},children:[(0,l.jsx)(i.Z,{style:{display:"flex",gap:"8px"},span:16}),(0,l.jsx)(s.ZP,{type:"primary",icon:(0,l.jsx)(m.Z,{}),iconPosition:"start",onClick:()=>{A(!0)},children:"Add admin"})]}),(0,l.jsx)(d.Z,{columns:O,dataSource:p.map(e=>({...e,key:e._id})),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1})]})]})}},19486:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var l=t(91413),r=t(86863);class s{}s.getAllRoles=async()=>{try{return await r.O.get(l.P.GET_ALL_ROLES)}catch(e){throw console.error(e),e}},s.getActiveRoles=async()=>{try{return await r.O.get(l.P.GET_ACTIVE_ROLES)}catch(e){throw console.error(e),e}},s.getModules=async e=>{try{return await r.O.get(l.P.GET_MODULES,{id:e})}catch(e){throw console.error(e),e}},s.createRole=async e=>{try{return await r.O.post(l.P.CREATE_ROLE,e)}catch(e){throw console.error(e),e}},s.updateRole=async(e,a)=>{try{return await r.O.patch(l.P.UPDATE_ROLE,a,{id:e})}catch(e){throw console.error(e),e}}},99765:function(e,a,t){"use strict";t.d(a,{I:function(){return s}});var l=t(62737),r=t.n(l);class s{static formatDate(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.DEFAULT_DATE_FORMAT;return e?r()(e).format(a):""}}s.DEFAULT_DATE_FORMAT="YYYY-MM-DD",s.DEFAULT_DATE_TIME_FORMAT="YYYY-MM-DD HH:mm:ss",s.CATEGORY_DATE_FORMAT="DD MMM YYYY"}},function(e){e.O(0,[3276,9665,3419,3454,5325,4717,7460,7382,7373,7738,4052,6487,5783,6326,806,183,4983,4183,7622,413,2971,7023,1744],function(){return e(e.s=78677)}),_N_E=e.O()}]);