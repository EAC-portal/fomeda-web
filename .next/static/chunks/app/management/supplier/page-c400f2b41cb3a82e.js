(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9341],{21664:function(e,t,a){Promise.resolve().then(a.bind(a,62945))},62945:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var n=a(57437),r=a(2265),i=a(50413),l=a(97382),d=a(21482),o=a(66018),s=a(9957),c=a(46682),u=a(77733),p=a(95381),y=a(25325),m=a(65783),h=a(68788),x=a(57834),_=a(77738),g=a(30252),k=a(41880),j=a(73454);let{TextArea:w}=y.default,{Title:f,Paragraph:v,Text:S}=g.default;var b=e=>{let{type:t,isOpen:a,onSubmit:r,onCancel:i}=e,[l]=j.Z.useForm(),d=async()=>{if("approve"===t)r(t);else if("reject"===t)try{let e=await l.validateFields();r(t,e.reason)}catch(e){return console.error("Validation Failed:",e),Promise.reject()}l.resetFields()};return(0,n.jsx)(_.Z,{title:"approve"===t?(0,n.jsx)("h3",{style:{textAlign:"center"},children:"Approval Confirmation"}):(0,n.jsx)("h3",{style:{textAlign:"center"},children:"Rejection Confirmation"}),open:a,centered:!0,onOk:d,onCancel:()=>{l.resetFields(),i()},width:800,okText:"Confirm",cancelText:"Cancel",children:"approve"===t?(0,n.jsxs)(v,{children:["Are you sure you want to approve this ",(0,n.jsx)(S,{strong:!0,children:"registration"}),"?"]}):(0,n.jsx)(j.Z,{form:l,layout:"vertical",children:(0,n.jsx)(j.Z.Item,{name:"reason",label:"Reason",rules:[{required:!0,message:"Please enter the rejection reason"}],children:(0,n.jsx)(w,{autoSize:{minRows:4,maxRows:8},placeholder:"Rejection reason"})})})})},I=a(44785),D=a(49714),T=a(99765);let{Text:C}=g.default;var A=e=>{let{visible:t,onClose:a,data:i,fetchData:l}=e,[d,s]=(0,r.useState)(!1),[u,p]=(0,r.useState)("approve"),y=async()=>{a()},x=e=>{p(e),s(!0)},g=()=>{p(void 0),s(!1)},j=async(e,t)=>{try{var a;let n;let r=I.Z.get("token");if(r)try{n=(0,D.o)(r)}catch(e){console.error(e)}let d=null!==(a=null==n?void 0:n.user_id)&&void 0!==a?a:"UndefinedAdmin";"approve"===e?await h.Z.approveSuppliers(null==i?void 0:i.user_id,{approved_by:d}):"reject"===e&&await h.Z.rejectSuppliers(null==i?void 0:i.user_id,{rejected_by:d,reason:t}),g(),y(),l()}catch(e){throw console.error(e),e}},w=o.q7.map(e=>"rejected_on"===e.key?{...e,render:(t,a)=>T.I.formatDate(a[e.key]),sorter:(t,a)=>new Date(t[e.key]).getTime()-new Date(a[e.key]).getTime(),defaultSortOrder:"ascend"}:{...e,sorter:(t,a)=>(t[e.key]||"").toString().localeCompare((a[e.key]||"").toString())});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(_.Z,{title:(0,n.jsx)("h3",{style:{textAlign:"center"},children:"Review supplier"}),open:t,onCancel:y,width:1e3,footer:[(0,n.jsx)(c.ZP,{onClick:()=>x("reject"),children:"Reject"},"reject"),(0,n.jsx)(c.ZP,{type:"primary",onClick:()=>x("approve"),children:"Approve"},"approve")],children:[(0,n.jsx)(k.Z,{title:(0,n.jsx)(C,{strong:!0,children:"Supplier details"}),bordered:!0,items:(e=>{if(!e)return[];let t=["_id","key","user_id","rejection"],a=["email_address","company_address","registered_on"];return Object.entries(e).filter(e=>{let[a]=e;return!t.includes(a)}).map(e=>{let[t,n]=e;return{key:t,label:o.P4[t],children:"registered_on"===t?T.I.formatDate(new Date(n)):n,span:a.includes(t)?3:1}})})(i),column:2}),(0,n.jsx)("div",{style:{margin:"16px 0"},children:(0,n.jsx)(C,{strong:!0,children:"Supplier rejection history"})}),(0,n.jsx)(m.Z,{dataSource:null==i?void 0:i.rejection,columns:w,pagination:!1,locale:{emptyText:"No rejection history"}})]}),(0,n.jsx)(b,{isOpen:d,type:u,onSubmit:j,onCancel:g})]})},Z=e=>{let{setLoading:t}=e,[a,i]=(0,r.useState)([]),[l,d]=(0,r.useState)([]),[_,g]=(0,r.useState)(""),[k,j]=(0,r.useState)(""),[w,f]=(0,r.useState)([null,null]),[v,S]=(0,r.useState)(!1),[b,I]=(0,r.useState)(null),{RangePicker:D}=s.default,C=(0,r.useCallback)(async()=>{try{t(!0);let e=await h.Z.getPendingSuppliers();i(e),d(e)}catch(e){console.error(e)}finally{t(!1)}},[t]);(0,r.useEffect)(()=>{C()},[t,C]),(0,r.useEffect)(()=>{d(a.filter(e=>{let t=""===_||RegExp(_,"i").test(e.fullname),a=""===k||RegExp(k,"i").test(e.company_name),n=new Date(e.registered_on).setHours(0,0,0,0),[r,i]=w||[null,null],l=r?new Date(r).setHours(0,0,0,0):null,d=i?new Date(i).setHours(0,0,0,0):null;return t&&a&&(!l||!d||n>=l&&n<=d)}))},[_,k,w,a]);let Z=(e,t)=>{I(t),S(!0)},R=o.xo.map(e=>{switch(e.key){case"actions":return{...e,render:(e,t)=>(0,n.jsx)(c.ZP,{onClick:()=>Z(e,t),children:"Review"})};case"registered_on":return{...e,render:(t,a)=>T.I.formatDate(a[e.key]),sorter:(t,a)=>new Date(t[e.key]).getTime()-new Date(a[e.key]).getTime()};default:return{...e,sorter:(t,a)=>(t[e.key]||"").toString().localeCompare((a[e.key]||"").toString())}}});return(0,n.jsxs)("div",{children:[(0,n.jsx)(A,{visible:v,onClose:()=>S(!1),data:b,fetchData:C}),(0,n.jsxs)("div",{style:{width:"100%"},children:[(0,n.jsx)(u.Z,{style:{marginBottom:16},children:(0,n.jsxs)(p.Z,{span:24,style:{display:"flex",gap:"8px"},children:[(0,n.jsx)(y.default,{placeholder:"Supplier name",onChange:e=>g(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"20%"}}),(0,n.jsx)(y.default,{placeholder:"Trading company",onChange:e=>j(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"49%"}}),(0,n.jsx)(D,{onChange:e=>f(e)})]})}),(0,n.jsx)(m.Z,{columns:R,dataSource:l.map(e=>({...e,key:e._id})),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1})]})]})};let{Text:R}=g.default;var P=e=>{let{visible:t,onClose:a,data:r}=e,i=async()=>{a()},l=o.q7.map(e=>"rejected_on"===e.key?{...e,render:(t,a)=>T.I.formatDate(a[e.key]),sorter:(t,a)=>new Date(t[e.key]).getTime()-new Date(a[e.key]).getTime(),defaultSortOrder:"descend"}:{...e,sorter:(t,a)=>(t[e.key]||"").toString().localeCompare((a[e.key]||"").toString())});return(0,n.jsxs)(_.Z,{title:(0,n.jsx)("h3",{style:{textAlign:"center"},children:"View supplier"}),open:t,onCancel:i,width:1e3,footer:null,children:[(0,n.jsx)(k.Z,{title:(0,n.jsx)(R,{strong:!0,children:"Supplier details"}),bordered:!0,items:(e=>{if(!e)return[];let t=["_id","key","user_id","rejection"],a=["email_address","company_address","registered_on"];return Object.entries(e).filter(e=>{let[a]=e;return!t.includes(a)}).map(e=>{let[t,n]=e;return{key:t,label:o.A7[t],children:"registered_on"===t||"approved_on"===t||"last_rejected_on"===t?T.I.formatDate(new Date(n)):n,span:a.includes(t)?3:1}})})(r),column:2}),(0,n.jsx)("div",{style:{margin:"16px 0"},children:(0,n.jsx)(R,{strong:!0,children:"Supplier rejection history"})}),(0,n.jsx)(m.Z,{dataSource:null==r?void 0:r.rejection,columns:l,pagination:!1,locale:{emptyText:"No rejection history"}})]})},E=e=>{let{setLoading:t}=e,[a,i]=(0,r.useState)([]),[l,d]=(0,r.useState)([]),[_,g]=(0,r.useState)(""),[k,j]=(0,r.useState)(""),[w,f]=(0,r.useState)([null,null]),[v,S]=(0,r.useState)(!1),[b,I]=(0,r.useState)(null),{RangePicker:D}=s.default;(0,r.useEffect)(()=>{(async()=>{try{let e=await h.Z.getApprovedSuppliers();i(e),d(e)}catch(e){throw console.error(e),e}finally{t(!1)}})()},[t]),(0,r.useEffect)(()=>{d(a.filter(e=>{let t=""===_||RegExp(_,"i").test(e.fullname),a=""===k||RegExp(k,"i").test(e.company_name),n=new Date(e.approved_on).setHours(0,0,0,0),[r,i]=w||[null,null],l=r?new Date(r).setHours(0,0,0,0):null,d=i?new Date(i).setHours(0,0,0,0):null;return t&&a&&(!l||!d||n>=l&&n<=d)}))},[_,k,w,a]);let C=(e,t)=>{I(t),S(!0)},A=o.F_.map(e=>{switch(e.key){case"actions":return{...e,render:(e,t)=>(0,n.jsx)(c.ZP,{onClick:()=>C(e,t),children:"View"})};case"approved_on":return{...e,render:(t,a)=>T.I.formatDate(a[e.key]),sorter:(t,a)=>new Date(t[e.key]).getTime()-new Date(a[e.key]).getTime()};default:return{...e,sorter:(t,a)=>(t[e.key]||"").toString().localeCompare((a[e.key]||"").toString())}}});return(0,n.jsxs)("div",{children:[(0,n.jsx)(P,{visible:v,onClose:()=>S(!1),data:b}),(0,n.jsxs)("div",{style:{width:"100%"},children:[(0,n.jsx)(u.Z,{style:{marginBottom:16},children:(0,n.jsxs)(p.Z,{span:24,style:{display:"flex",gap:"8px"},children:[(0,n.jsx)(y.default,{placeholder:"Supplier name",onChange:e=>g(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"20%"}}),(0,n.jsx)(y.default,{placeholder:"Trading company",onChange:e=>j(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"39%"}}),(0,n.jsx)(D,{onChange:e=>f(e)})]})}),(0,n.jsx)(m.Z,{columns:A,dataSource:l.map(e=>({...e,key:e._id})),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1})]})]})},M=e=>{let{setLoading:t}=e,[a,i]=(0,r.useState)([]),[l,d]=(0,r.useState)([]),[_,g]=(0,r.useState)(""),[k,j]=(0,r.useState)(""),[w,f]=(0,r.useState)([null,null]),[v,S]=(0,r.useState)(!1),[b,I]=(0,r.useState)(null),{RangePicker:D}=s.default;(0,r.useEffect)(()=>{(async()=>{try{let e=await h.Z.getRejectedSuppliers();i(e),d(e)}catch(e){throw console.error(e),e}finally{t(!1)}})()},[t]),(0,r.useEffect)(()=>{d(a.filter(e=>{let t=""===_||RegExp(_,"i").test(e.fullname),a=""===k||RegExp(k,"i").test(e.company_name),n=new Date(e.last_rejected_on).setHours(0,0,0,0),[r,i]=w||[null,null],l=r?new Date(r).setHours(0,0,0,0):null,d=i?new Date(i).setHours(0,0,0,0):null;return t&&a&&(!l||!d||n>=l&&n<=d)}))},[_,k,w,a]);let C=(e,t)=>{I(t),S(!0)},A=o.lm.map(e=>{switch(e.key){case"actions":return{...e,render:(e,t)=>(0,n.jsx)(c.ZP,{onClick:()=>C(e,t),children:"View"})};case"last_rejected_on":return{...e,render:(t,a)=>T.I.formatDate(a[e.key]),sorter:(t,a)=>new Date(t[e.key]).getTime()-new Date(a[e.key]).getTime()};default:return{...e,sorter:(t,a)=>(t[e.key]||"").toString().localeCompare((a[e.key]||"").toString())}}});return(0,n.jsxs)("div",{children:[(0,n.jsx)(P,{visible:v,onClose:()=>S(!1),data:b}),(0,n.jsxs)("div",{style:{width:"100%"},children:[(0,n.jsx)(u.Z,{style:{marginBottom:16},children:(0,n.jsxs)(p.Z,{span:24,style:{display:"flex",gap:"8px"},children:[(0,n.jsx)(y.default,{placeholder:"Supplier name",onChange:e=>g(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"20%"}}),(0,n.jsx)(y.default,{placeholder:"Trading company",onChange:e=>j(e.target.value),prefix:(0,n.jsx)(x.Z,{}),size:"large",style:{width:"39%"}}),(0,n.jsx)(D,{onChange:e=>f(e)})]})}),(0,n.jsx)(m.Z,{columns:A,dataSource:l.map(e=>({...e,key:e._id})),pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},showSorterTooltip:!1})]})]})},z=a(16463),O=()=>{let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)("pending"),[c,u]=(0,r.useState)(),p=(0,z.useRouter)();return(0,r.useEffect)(()=>{},[p]),(0,n.jsx)(l.Z,{spinning:e,children:(0,n.jsxs)(i.default,{title:"Suppliers Management",children:[(0,n.jsx)("div",{children:(0,n.jsx)(d.Z,{options:o.ro,value:a,onChange:e=>{s(e)},style:{marginBottom:16,padding:0}})}),"pending"===a?(0,n.jsx)(Z,{setLoading:t}):"rejected"===a?(0,n.jsx)(M,{setLoading:t}):"approved"===a?(0,n.jsx)(E,{setLoading:t}):void 0]})})}},66018:function(e,t,a){"use strict";a.d(t,{A7:function(){return d},F_:function(){return l},GY:function(){return h},Jl:function(){return c},M6:function(){return _},P4:function(){return i},at:function(){return m},dZ:function(){return p},k:function(){return u},lm:function(){return o},q7:function(){return s},ro:function(){return n},vu:function(){return x},xo:function(){return r},zM:function(){return y}});let n=[{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"},{label:"Approved",value:"approved"}],r=[{key:"fullname",title:"Supplier name",dataIndex:"fullname",width:"20%"},{key:"company_name",title:"Trading company",dataIndex:"company_name"},{key:"registered_on",title:"Registered date",dataIndex:"registered_on",width:"15%"},{key:"actions",title:"Actions",width:"15%"}],i={fullname:"Supplier name",username:"Supplier username",email_address:"Supplier email address",company_name:"Trading company",company_no:"Trading company no",company_address:"Trading company address",registered_on:"Registered date"},l=[{key:"fullname",title:"Supplier name",dataIndex:"fullname",width:"20%"},{key:"company_name",title:"Trading company",dataIndex:"company_name"},{key:"approved_on",title:"Approved on",dataIndex:"approved_on",width:"15%"},{key:"approved_by",title:"Approved by",dataIndex:"approved_by",width:"15%"},{key:"actions",title:"Actions",width:"10%"}],d={fullname:"Supplier name",username:"Supplier username",email_address:"Supplier email address",company_name:"Trading company",company_no:"Trading company no",company_address:"Trading company address",registered_on:"Registered date",approved_by:"Approved by",approved_on:"Approved date",last_rejected_by:"Last rejected by",last_rejected_on:"Last rejected date"},o=[{key:"fullname",title:"Supplier name",dataIndex:"fullname",width:"20%"},{key:"company_name",title:"Trading company",dataIndex:"company_name"},{key:"last_rejected_on",title:"Last rejected on",dataIndex:"last_rejected_on",width:"15%"},{key:"last_rejected_by",title:"Last rejected by",dataIndex:"last_rejected_by",width:"15%"},{key:"actions",title:"Actions",width:"10%"}],s=[{key:"reason",title:"Reason",dataIndex:"reason",width:"60%"},{key:"rejected_on",title:"Rejected on",dataIndex:"rejected_on",width:"20%"},{key:"rejected_by",title:"Rejected by",dataIndex:"rejected_by",width:"20%"}],c=[{key:"product",label:"Product",value:"product"},{key:"pending",label:"Pending",value:"pending"},{key:"history",label:"History",value:"history"},{key:"report",label:"Report",value:"report"}],u=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"30%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"rating",title:"Rating",dataIndex:"rating",width:"10%"},{key:"last_updated_on",title:"Last Updated",dataIndex:"last_updated_on",width:"10%"},{key:"is_active",title:"Active",dataIndex:"is_active",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],p=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"50%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"last_updated_on",title:"Last Updated",dataIndex:"last_updated_on",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],y=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"30%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"rating",title:"Rating",dataIndex:"rating",width:"10%"},{key:"reviewed_on",title:"Reviewed on",dataIndex:"reviewed_on",width:"10%"},{key:"status",title:"Status",dataIndex:"status",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],m=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"40%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"created_on",title:"Reported On",dataIndex:"created_on",width:"10%"},{key:"sup_status",title:"Supplier Action",dataIndex:"sup_status",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],h=[{key:"view_product",label:"View Product",link:""},{key:"deactivate",label:"Deactivate Product",link:""},{key:"activate",label:"Activate Product",link:""},{key:"delete",label:"Delete Product",link:""}],x=[{key:"view_product",label:"View Product",link:""},{key:"delete",label:"Delete Product",link:""}],_=[{key:"view_product",label:"View Product",link:""},{key:"resubmit",label:"Resubmit Application",link:""},{key:"delete",label:"Delete Application",link:""}]},99765:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var n=a(62737),r=a.n(n);class i{static formatDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.DEFAULT_DATE_FORMAT;return e?r()(e).format(t):""}}i.DEFAULT_DATE_FORMAT="YYYY-MM-DD",i.DEFAULT_DATE_TIME_FORMAT="YYYY-MM-DD HH:mm:ss",i.CATEGORY_DATE_FORMAT="DD MMM YYYY"}},function(e){e.O(0,[3276,9665,3419,3454,5325,252,7460,7382,7373,7738,4052,6487,5783,806,9957,2197,413,2971,7023,1744],function(){return e(e.s=21664)}),_N_E=e.O()}]);