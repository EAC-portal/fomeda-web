(()=>{var e={};e.id=8172,e.ids=[8172],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},78514:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(84666),r(49864),r(35866);var a=r(23191),s=r(88716),n=r(37922),i=r.n(n),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["management",{children:["report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,84666)),"C:\\Users\\User\\Desktop\\Project\\fomeda-web\\src\\app\\management\\report\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,49864)),"C:\\Users\\User\\Desktop\\Project\\fomeda-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\User\\Desktop\\Project\\fomeda-web\\src\\app\\management\\report\\page.tsx"],u="/management/report/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/management/report/page",pathname:"/management/report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},43768:(e,t,r)=>{Promise.resolve().then(r.bind(r,95913))},95913:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>D});var a=r(10326),s=r(52783),n=r(91726),i=r(1595),o=r(4139),l=r(38106),d=r(59270),c=r(60816),u=r(17577),p=r.n(u),m=r(14204),h=r(92379),x=r(82412),_=r(90434),y=r(56230),g=r(74299),w=r(77490);let f=({filterData:e})=>{let[t,r]=(0,u.useState)([]),[s,n]=(0,u.useState)(!1),[i,o]=(0,u.useState)(!1),[l,d]=(0,u.useState)(),[p,f]=(0,u.useState)(),j=(0,u.useCallback)(async()=>{try{n(!0),e.adm_status_list=[m.a5.PENDING,m.a5.NOTIFIED];let t=await g.Z.getAdminReportListByFilter(e);t&&r(t)}catch(e){throw console.error(e),e}finally{n(!1)}},[e]);(0,u.useEffect)(()=>{j().then()},[j]);let b=e=>{d(e._id),f(e.product_name),o(!0)},S=m.Lu.map(e=>{switch(e.key){case"product_name":return{...e,render:(e,t)=>a.jsx(_.default,{href:`/product/details?id=${t.pro_id}`,children:t.product_name})};case"created_on":return{...e,render:(t,r)=>y.I.formatDate(r[e.key],y.I.CATEGORY_DATE_FORMAT),sorter:(t,r)=>new Date(t[e.key]).getTime()-new Date(r[e.key]).getTime()};case"sup_status":return{...e,render:(e,t)=>P(t.sup_status)};case"adm_status":return{...e,render:(e,t)=>P(t.adm_status)};case"actions":return{...e,render:(e,t)=>a.jsx(c.ZP,{onClick:()=>b(t),children:"View Details"})};default:return{...e,sorter:(t,r)=>(t[e.key]||"").toString().localeCompare((r[e.key]||"").toString())}}}),P=e=>{switch(e){case m.a5.NOTIFIED:return a.jsx(h.Z,{color:"blue",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Notified Owner"});case m.a5.PENDING:return a.jsx(h.Z,{color:"yellow",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Pending"});case m.a5.CLOSED:return a.jsx(h.Z,{color:"red",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Closed"});default:return a.jsx("div",{children:"-"})}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(x.Z,{className:"mt-4",columns:S,showSorterTooltip:!1,dataSource:t,rowKey:"_id",loading:s,pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]}}),i&&a.jsx(w.Z,{onOpen:i,onClose:()=>o(!1),reportId:l,productName:p,onUpdate:()=>{j().then()}})]})},j=({filterData:e})=>{let[t,r]=p().useState([]),[s,n]=p().useState(!1),[i,o]=(0,u.useState)(!1),[l,d]=(0,u.useState)(),[f,j]=(0,u.useState)();(0,u.useEffect)(()=>{(async()=>{try{n(!0),e.adm_status_list=[m.a5.CLOSED];let t=await g.Z.getAdminReportListByFilter(e);t&&r(t)}catch(e){throw console.error(e),e}finally{n(!1)}})().then()},[e]);let b=e=>{d(e._id),j(e.product_name),o(!0)},S=m.Pf.map(e=>{switch(e.key){case"product_name":return{...e,render:(e,t)=>a.jsx(_.default,{href:`/product/details?id=${t.pro_id}`,children:t.product_name})};case"reviewed_on":return{...e,render:(t,r)=>y.I.formatDate(r[e.key],y.I.CATEGORY_DATE_FORMAT),sorter:(t,r)=>new Date(t[e.key]).getTime()-new Date(r[e.key]).getTime()};case"adm_status":return{...e,render:(e,t)=>P(t.adm_status)};case"actions":return{...e,render:(e,t)=>a.jsx(c.ZP,{onClick:()=>b(t),children:"View Details"})};default:return{...e,sorter:(t,r)=>(t[e.key]||"").toString().localeCompare((r[e.key]||"").toString())}}}),P=e=>{switch(e){case m.a5.NOTIFIED:return a.jsx(h.Z,{color:"blue",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Notified Owner"});case m.a5.PENDING:return a.jsx(h.Z,{color:"yellow",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Pending"});case m.a5.CLOSED:return a.jsx(h.Z,{color:"red",bordered:!1,className:"px-3 py-0.5 rounded-xl",children:"Closed"});default:return a.jsx("div",{children:"-"})}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(x.Z,{className:"mt-4",columns:S,showSorterTooltip:!1,dataSource:t,rowKey:"_id",loading:s,pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]}}),i&&a.jsx(w.Z,{onOpen:i,onClose:()=>o(!1),reportId:l,productName:f})]})};var b=r(24395),S=r(89792),P=r(96327);let D=()=>{let[e,t]=(0,u.useState)(m.Dh[0].value),[r]=n.Z.useForm(),[p,h]=(0,u.useState)({}),[x,_]=(0,u.useState)([]),[y,g]=(0,u.useState)([]),[w,D]=(0,u.useState)(!1);(0,u.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("report_segmented_tab");e&&t(e)},[]),(0,u.useEffect)(()=>{let e=e=>{e.state?.segmentedTab&&t(e.state.segmentedTab)};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]);let E=async()=>{try{D(!0);let e=await P.Z.findAllActiveCategories();if(e){let t=e.map(e=>{let t=e.children?.map(e=>({title:e.subcat_name,value:e._id,key:e._id}));return{title:e.cat_name,value:e._id,key:e._id,children:t}});_(t)}}catch(e){throw console.error(e),e}};(0,u.useEffect)(()=>{E().then(()=>D(!1))},[]);let C=async()=>{h(r.getFieldsValue())},I=async()=>{r.resetFields(),h(r.getFieldsValue())};return(0,a.jsxs)(s.default,{title:"Report Management",children:[a.jsx(i.Z,{options:m.Dh,onChange:e=>{t(e),window.history.pushState({segmentedTab:e},"",`?report_segmented_tab=${e}`),h({}),r.resetFields()},value:e}),a.jsx(o.Z,{className:"flex justify-between items-center space-x-3 mt-4",children:a.jsx(l.Z,{flex:"auto",children:a.jsx(n.Z,{form:r,children:(0,a.jsxs)(o.Z,{className:"flex space-x-3",children:[a.jsx(n.Z.Item,{name:"search",className:"w-1/3 m-0",children:a.jsx(d.default,{prefix:a.jsx(b.Z,{}),placeholder:"Product Name / Model Number",size:"large"})}),a.jsx(n.Z.Item,{name:"subcat_ids",className:"w-1/6 m-0",children:a.jsx(S.Z,{placeholder:"Category",options:x,showSearch:!0,optionsPlaceholder:"Search Category...",onChange:e=>{g(e)},values:y,size:"large",loading:w})}),a.jsx(c.ZP,{type:"primary",onClick:C,size:"large",children:"Search"}),a.jsx(c.ZP,{type:"default",onClick:I,size:"large",children:"Reset"})]})})})}),"pending"===e&&a.jsx(f,{filterData:p}),"history"===e&&a.jsx(j,{filterData:p})]})}},89792:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var a=r(10326),s=r(59270),n=r(276),i=r(4139),o=r(92379),l=r(68221),d=r(17577),c=r(24395);let u=({options:e,placeholder:t,optionsPlaceholder:r,onChange:u,values:p,showSearch:m=!1,...h})=>{let[x,_]=(0,d.useState)([]);(0,d.useEffect)(()=>{_(e)},[e]);let y=(e,t)=>t?e.split(RegExp(`(${t})`,"gi")).map((e,r)=>e.toLowerCase()===t.toLowerCase()?a.jsx("span",{className:"text-blue-700 font-bold",children:e},r):e):e,g=t=>{let r=t.trim().toLowerCase();_(e.map(e=>{let t=e.title.toLowerCase().includes(r),a=e.children?.filter(e=>e.title.toLowerCase().includes(r))||[];return t||a.length>0?{...e,title:t?y(e.title,r):e.title,children:a.length>0?a.map(e=>({...e,title:y(e.title,r)})):e.children}:null}).filter(e=>null!==e))};return a.jsx(l.Z,{className:"custom-select",treeData:x,placeholder:t,dropdownRender:e=>(0,a.jsxs)(a.Fragment,{children:[m&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(s.default,{onChange:e=>g(e.target.value),placeholder:r??"Search...",variant:"borderless",prefix:a.jsx(c.Z,{}),onKeyDown:e=>e.stopPropagation()}),a.jsx(n.Z,{className:"mb-3 mt-0.5 border-gray-300"})]}),e]}),tagRender:e=>{let{label:r}=e;return(0,a.jsxs)(i.Z,{children:[a.jsx(o.Z,{style:{backgroundColor:"var(--ant-primary-color)",color:"white",borderRadius:"20px"},children:r}),a.jsx("div",{children:t})]})},onChange:u,maxTagCount:0,showSearch:!1,maxTagPlaceholder:()=>p?.length?p.length:null,treeCheckable:!0,...h})}},42508:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(10326);let s=({action:e,record:t,details:r})=>(0,a.jsxs)("div",{children:[a.jsx("br",{}),"Are you confirmed to ",a.jsx("b",{children:e})," this ",r,"?",a.jsx("br",{}),(0,a.jsxs)("div",{children:[a.jsx("b",{children:"Product:"})," ",t.product_name]}),a.jsx("br",{})]})},77490:(e,t,r)=>{"use strict";r.d(t,{Z:()=>_});var a=r(10326),s=r(91726),n=r(94368),i=r(60816),o=r(82991),l=r(99985),d=r(38579),c=r(80314),u=r(17577),p=r(74299),m=r(73916),h=r(14204),x=r(42508);let _=({onOpen:e,onClose:t,reportId:r,productName:_,onUpdate:y,user:g="admin"})=>{let[w]=s.Z.useForm(),[f,j]=(0,u.useState)([]),[b,S]=(0,u.useState)(!1),[P,D]=(0,u.useState)(""),[E,C]=(0,u.useState)({}),[I,T]=(0,u.useState)(!1),[v,N]=(0,u.useState)(!1);(0,u.useEffect)(()=>{(async()=>{try{T(!0);let e=await p.Z.getReportDetails(r);if(e){if(e.rpt_img){let t=[{uid:e.rpt_img.uid,name:e.rpt_img.name,status:"done",thumbUrl:e.rpt_img.base64}];j(t)}C(e)}}catch(e){throw console.error(e),e}finally{T(!1)}})().then()},[r]);let Z=async e=>{n.Z.confirm({title:a.jsx("h3",{children:"Confirmation"}),content:a.jsx(x.Z,{action:h.d2[e],record:{product_name:_},details:"report"}),className:"confirmation-modal",centered:!0,width:"35%",okText:"Confirm",onOk:()=>k(e)})},k=async e=>{try{N(!0);let a={};"admin"===g?a.adm_status=e:a.sup_status=e,await p.Z.updateReportStatus(r,a),t(),y(),m.Z.success("Review Product",`Report of ${_} is ${h.Uq[e]} successfully`)}catch(e){m.Z.error("Review Product",`Report of ${_} is failed to review`)}finally{N(!1)}},R=async e=>{D(e.thumbUrl||""),S(!0)},O=[a.jsx(i.ZP,{type:"default",onClick:t,children:"Cancel"},"cancel"),a.jsx(i.ZP,{type:"primary",loading:v,onClick:()=>Z(h.a5.NOTIFIED),hidden:"supplier"===g,disabled:E.adm_status===h.a5.NOTIFIED,children:"Notify Owner"},"notify"),a.jsx(i.ZP,{type:"primary",danger:!0,loading:v,onClick:()=>Z(h.a5.CLOSED),disabled:E.sup_status===h.a5.PENDING&&"supplier"!==g,children:"Resolved"},"close")];return(0,a.jsxs)(n.Z,{open:e,onCancel:()=>{w.resetFields(),t()},title:a.jsx("h3",{className:"text-center",children:"Reported Details"}),width:"50%",footer:E.adm_status===h.a5.CLOSED||E.sup_status===h.a5.CLOSED&&"supplier"===g?null:O,children:[a.jsx(o.Z,{spinning:I,children:(0,a.jsxs)(s.Z,{form:w,children:[a.jsx(s.Z.Item,{label:a.jsx("h5",{children:"Product Name"}),className:"mb-2",labelAlign:"left",labelCol:{span:6},children:a.jsx("div",{children:_})}),a.jsx(s.Z.Item,{label:a.jsx("h5",{children:"Title"}),className:"mb-2",labelAlign:"left",labelCol:{span:6},children:a.jsx("div",{children:E.rpt_title})}),a.jsx(s.Z.Item,{label:a.jsx("h5",{children:"Reason"}),className:"mb-2",labelAlign:"left",labelCol:{span:6},children:a.jsx(l.default.Paragraph,{ellipsis:{rows:4,expandable:!0,symbol:"more"},children:E.rpt_reason})}),E.rpt_img&&a.jsx(d.Z,{listType:"picture",fileList:f,showUploadList:{showRemoveIcon:!1},onPreview:R,disabled:!0})]})}),P&&a.jsx(c.Z,{wrapperStyle:{display:"none"},preview:{visible:b,onVisibleChange:e=>S(e),afterOpenChange:e=>!e&&D("")},src:P,alt:"report-image"})]})}},14204:(e,t,r)=>{"use strict";r.d(t,{Dh:()=>s,Lu:()=>n,Pf:()=>i,Uq:()=>o,a5:()=>a,d2:()=>l});class a{static{this.PENDING="PENDING"}static{this.NOTIFIED="NOTIFIED"}static{this.CLOSED="CLOSED"}}let s=[{key:"pending",label:"Pending",value:"pending"},{key:"history",label:"History",value:"history"}],n=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"30%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"created_on",title:"Reported On",dataIndex:"created_on",width:"10%"},{key:"sup_status",title:"Supplier Action",dataIndex:"sup_status",width:"10%"},{key:"adm_status",title:"Status",dataIndex:"adm_status",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],i=[{key:"product_name",title:"Product Name",dataIndex:"product_name",width:"30%"},{key:"model_no",title:"Model No",dataIndex:"model_no",width:"10%"},{key:"cat_name",title:"Category",dataIndex:"cat_name",width:"10%"},{key:"subcat_name",title:"Subcategory",dataIndex:"subcat_name",width:"10%"},{key:"reviewed_on",title:"Reviewed on",dataIndex:"reviewed_on",width:"10%"},{key:"reviewed_by",title:"Reviewed by",dataIndex:"reviewed_by",width:"10%"},{key:"adm_status",title:"Status",dataIndex:"adm_status",width:"10%"},{key:"actions",title:"Actions",dataIndex:"action",width:"10%"}],o={NOTIFIED:"notified owner",CLOSED:"closed"},l={NOTIFIED:"inform owner",CLOSED:"resolve"}},74299:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(63506),s=r(12111);class n{static{this.createReport=async e=>{try{return await a.O.post(s.P.CREATE_REPORT,e)}catch(e){throw console.error(e),e}}}static{this.getReportDetails=async e=>{try{return await a.O.get(s.P.GET_REPORT_DETAILS,{id:e})}catch(e){throw console.error(e),e}}}static{this.getSupplierReportListByFilter=async e=>{try{return await a.O.post(s.P.GET_SUPPLIER_REPORT_LIST_BY_FILTER,e)}catch(e){throw console.error(e),e}}}static{this.getAdminReportListByFilter=async e=>{try{return await a.O.post(s.P.GET_ADMIN_REPORT_LIST_BY_FILTER,e)}catch(e){throw console.error(e),e}}}static{this.updateReportStatus=async(e,t)=>{try{return await a.O.put(s.P.UPDATE_REPORT_STATUS,t,{id:e})}catch(e){throw console.error(e),e}}}}},56230:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var a=r(88295),s=r.n(a);class n{static{this.DEFAULT_DATE_FORMAT="YYYY-MM-DD"}static{this.DEFAULT_DATE_TIME_FORMAT="YYYY-MM-DD HH:mm:ss"}static{this.CATEGORY_DATE_FORMAT="DD MMM YYYY"}static formatDate(e,t=n.DEFAULT_DATE_FORMAT){return e?s()(e).format(t):""}}},84666:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>o});var a=r(68570);let s=(0,a.createProxy)(String.raw`C:\Users\User\Desktop\Project\fomeda-web\src\app\management\report\page.tsx`),{__esModule:n,$$typeof:i}=s;s.default;let o=(0,a.createProxy)(String.raw`C:\Users\User\Desktop\Project\fomeda-web\src\app\management\report\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,349,4052,1775,1726,9270,9985,1259,2991,3118,4368,462,124,706,7042,8579,6242,1507,8492,6327],()=>r(78514));module.exports=a})();